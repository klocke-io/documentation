import{_ as i,c as a,o as e,a2 as n}from"./chunks/framework.B8WFj13S.js";const c=JSON.parse('{"title":"Getting Started Locally With Gardenadm","description":"","frontmatter":{"github_repo":"https://github.com/gardener/gardener","github_subdir":"docs/deployment","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/docs/gardener/deployment/getting_started_locally_with_gardenadm.md","to":"getting_started_locally_with_gardenadm.md"},"title":"Getting Started Locally With Gardenadm","prev":false,"next":false},"headers":[],"relativePath":"docs/gardener/deployment/getting_started_locally_with_gardenadm/index.md","filePath":"docs/gardener/deployment/getting_started_locally_with_gardenadm.md","lastUpdated":null}'),t={name:"docs/gardener/deployment/getting_started_locally_with_gardenadm/index.md"};function h(l,s,p,r,o,d){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="deploying-autonomous-shoot-clusters-locally" tabindex="-1">Deploying Autonomous Shoot Clusters Locally <a class="header-anchor" href="#deploying-autonomous-shoot-clusters-locally" aria-label="Permalink to &quot;Deploying Autonomous Shoot Clusters Locally&quot;">​</a></h1><div class="caution custom-block github-alert"><p class="custom-block-title">CAUTION</p><p>The <code>gardenadm</code> tool is currently under development and considered highly experimental. Do not use it in production environments. Read more about it in <a href="https://github.com/gardener/gardener/blob/master/docs/proposals/28-autonomous-shoot-clusters.md" target="_blank" rel="noreferrer">GEP-28</a>.</p></div><p>This document walks you through deploying Autonomous Shoot Clusters using <code>gardenadm</code> on your local machine. This setup can be used for trying out and developing <code>gardenadm</code> locally without additional infrastructure. The setup is also used for running e2e tests for <code>gardenadm</code> in CI (<a href="https://prow.gardener.cloud" target="_blank" rel="noreferrer">Prow</a>).</p><p>If you encounter difficulties, please open an issue so that we can make this process easier.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p><code>gardenadm</code> is a command line tool for bootstrapping Kubernetes clusters called &quot;Autonomous Shoot Clusters&quot;. Read the <a href="documentation/pr-preview/pr-2/docs/gardener/concepts/gardenadm/"><code>gardenadm</code> documentation</a> for more details on its concepts.</p><p>In this guide, we will start a <a href="https://kind.sigs.k8s.io/" target="_blank" rel="noreferrer">KinD</a> cluster which hosts pods serving as machines for the autonomous shoot cluster – just as for shoot clusters of <a href="documentation/pr-preview/pr-2/docs/gardener/extensions/provider-local/">provider-local</a>. The setup supports both the high-touch and medium-touch scenario of <code>gardenadm</code>.</p><p>Based on <a href="https://skaffold.dev/" target="_blank" rel="noreferrer">Skaffold</a>, the container images for all required components will be built and deployed into the cluster. This also includes the <code>gardenadm</code> CLI, which is installed on the machine pods by pulling the container image and extracting the binary.</p><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li>Make sure that you have followed the <a href="documentation/pr-preview/pr-2/docs/gardener/local_setup/">Local Setup guide</a> up until the <a href="documentation/pr-preview/pr-2/docs/gardener/local_setup/#get-the-sources">Get the sources</a> step.</li><li>Make sure your Docker daemon is up-to-date, up and running and has enough resources (at least <code>8</code> CPUs and <code>8Gi</code> memory; see <a href="https://docs.docker.com/desktop/mac/#resources" target="_blank" rel="noreferrer">here</a> how to configure the resources for Docker for Mac). <blockquote><p>Additionally, please configure at least <code>120Gi</code> of disk size for the Docker daemon.</p></blockquote></li></ul><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p>You can clean up unused data with <code>docker system df</code> and <code>docker system prune -a</code>.</p></div><h2 id="setting-up-the-kind-cluster" tabindex="-1">Setting Up the KinD Cluster <a class="header-anchor" href="#setting-up-the-kind-cluster" aria-label="Permalink to &quot;Setting Up the KinD Cluster&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-up</span></span></code></pre></div><p>Please see <a href="documentation/pr-preview/pr-2/docs/gardener/deployment/getting_started_locally/#setting-up-the-kind-cluster-garden-and-seed">this documentation section</a> for more details.</p><p>All following steps assume that you are using the kubeconfig for this KinD cluster:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> KUBECONFIG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PWD/example/gardener-local/kind/local/kubeconfig</span></span></code></pre></div><h2 id="high-touch-scenario" tabindex="-1">High-Touch Scenario <a class="header-anchor" href="#high-touch-scenario" aria-label="Permalink to &quot;High-Touch Scenario&quot;">​</a></h2><p>Use the following command to prepare the <code>gardenadm</code> high-touch scenario:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span></span></code></pre></div><p>This will first build the needed images, deploy 2 machine pods using the <a href="https://github.com/gardener/gardener/tree/master/pkg/provider-local/node" target="_blank" rel="noreferrer"><code>gardener-extension-provider-local-node</code> image</a>, install the <code>gardenadm</code> binary on both of them, and copy the needed manifests to the <code>/gardenadm/resources</code> directory.</p><p>Afterward, you can use <code>kubectl exec</code> to execute <code>gardenadm</code> commands on the machines.</p><p>Let&#39;s start with exec&#39;ing into the <code>machine-0</code> pod:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bootstraps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> autonomous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shoot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clusters</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Gardener</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> project.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /gardenadm/resources/manifests.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apiVersion:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> core.gardener.cloud/v1beta1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kind:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CloudProfile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> local</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><h3 id="bootstrapping-a-single-node-control-plane" tabindex="-1">Bootstrapping a Single-Node Control Plane <a class="header-anchor" href="#bootstrapping-a-single-node-control-plane" aria-label="Permalink to &quot;Bootstrapping a Single-Node Control Plane&quot;">​</a></h3><p>Use <code>gardenadm init</code> to bootstrap the first control plane node using the provided manifests:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /gardenadm/resources</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Shoot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> control-plane</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initialized</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><h3 id="connecting-to-the-autonomous-shoot-cluster" tabindex="-1">Connecting to the Autonomous Shoot Cluster <a class="header-anchor" href="#connecting-to-the-autonomous-shoot-cluster" aria-label="Permalink to &quot;Connecting to the Autonomous Shoot Cluster&quot;">​</a></h3><p>The machine pod&#39;s shell environment is configured for easily connecting to the autonomous shoot cluster. Just execute <code>kubectl</code> within a <code>bash</code> shell in the machine pod:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ROLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">machine-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Ready</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   4m11s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   v1.32.0</span></span></code></pre></div><p>You can also copy the kubeconfig to your local machine and use a port-forward to connect to the cluster&#39;s API server:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/kubernetes/admin.conf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/api.root.garden.internal.gardenadm.local/localhost:6443/&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /tmp/shoot--garden--root.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pod/machine-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 6443:443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># in a new terminal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KUBECONFIG=/tmp/shoot--garden--root.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ROLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">machine-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Ready</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   10m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   v1.32.0</span></span></code></pre></div><h3 id="joining-a-worker-node" tabindex="-1">Joining a Worker Node <a class="header-anchor" href="#joining-a-worker-node" aria-label="Permalink to &quot;Joining a Worker Node&quot;">​</a></h3><p>If you would like to join a worker node to the cluster, generate a bootstrap token and the corresponding <code>gardenadm join</code> command on <code>machine-0</code> (the control plane node). Then exec into the <code>machine-1</code> pod to run the command:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> token</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --print-join-command</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># now copy the output, terminate the exec session and start a new one for machine-1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine-1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># paste the copied &#39;gardenadm join&#39; command here and execute it</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-1:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> join</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> has</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> been</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instructed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> join</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cluster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> worker!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></div><p>Using the kubeconfig as described in <a href="documentation/pr-preview/pr-2/docs/gardener/deployment/getting_started_locally_with_gardenadm/#connecting-to-the-autonomous-shoot-cluster">this section</a>, you should now be able to see the new node in the cluster:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ROLES</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    AGE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">machine-0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Ready</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   10m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   v1.32.0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">machine-1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   Ready</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">non</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   37s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   v1.32.0</span></span></code></pre></div><h2 id="medium-touch-scenario" tabindex="-1">Medium-Touch Scenario <a class="header-anchor" href="#medium-touch-scenario" aria-label="Permalink to &quot;Medium-Touch Scenario&quot;">​</a></h2><p>Use the following command to prepare the <code>gardenadm</code> medium-touch scenario:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SCENARIO=medium-touch</span></span></code></pre></div><p>This will first build the needed images and then render the needed manifests for <code>gardenadm bootstrap</code> to the <a href="https://github.com/gardener/gardener/tree/master/dev-setup/gardenadm/resources/generated/medium-touch" target="_blank" rel="noreferrer"><code>./dev-setup/gardenadm/resources/generated/medium-touch</code></a> directory.</p><p>Afterward, you can use <code>go run</code> to execute <code>gardenadm</code> commands on your machine:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IMAGEVECTOR_OVERWRITE=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PWD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/dev-setup/gardenadm/resources/generated/.imagevector-overwrite.yaml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./cmd/gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bootstrap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./dev-setup/gardenadm/resources/generated/medium-touch</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> work</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> progress</span></span></code></pre></div><h2 id="connecting-the-autonomous-shoot-cluster-to-gardener" tabindex="-1">Connecting the Autonomous Shoot Cluster to Gardener <a class="header-anchor" href="#connecting-the-autonomous-shoot-cluster-to-gardener" aria-label="Permalink to &quot;Connecting the Autonomous Shoot Cluster to Gardener&quot;">​</a></h2><p>After you have successfully bootstrapped an autonomous shoot cluster (either via the <a href="documentation/pr-preview/pr-2/docs/gardener/deployment/getting_started_locally_with_gardenadm/#high-touch-scenario">high touch</a> or the <a href="documentation/pr-preview/pr-2/docs/gardener/deployment/getting_started_locally_with_gardenadm/#medium-touch-scenario">medium touch</a> scenario), you can connect it to an existing Gardener system. For this, you need to have a Gardener running locally in your KinD cluster. In order to deploy it, you can run</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SCENARIO=connect</span></span></code></pre></div><p>This will deploy <a href="documentation/pr-preview/pr-2/docs/gardener/concepts/operator/"><code>gardener-operator</code></a> and create a <code>Garden</code> resource (which will then be reconciled and results in a full Gardener deployment). Find all information about it <a href="documentation/pr-preview/pr-2/docs/gardener/deployment/getting_started_locally/#alternative-way-to-set-up-garden-and-seed-leveraging-gardener-operator">here</a>. Note, that in this setup, no <code>Seed</code> will be registered in the Gardener - it&#39;s just a plain garden cluster without the ability to create regular shoot clusters.</p><p>Once above command is finished, you can connect the autonomous shoot cluster to this Gardener instance:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-high-touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@machine-0:/#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connect</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2025-07-03T12:21:49.586Z</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	INFO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> work</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> progress</span></span></code></pre></div><h2 id="running-e2e-tests-for-gardenadm" tabindex="-1">Running E2E Tests for <code>gardenadm</code> <a class="header-anchor" href="#running-e2e-tests-for-gardenadm" aria-label="Permalink to &quot;Running E2E Tests for \`gardenadm\`&quot;">​</a></h2><p>Based on the described setup, you can execute the e2e test suite for <code>gardenadm</code>:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SCENARIO=high-touch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SCENARIO=medium-touch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-e2e-local-gardenadm</span></span></code></pre></div><p>You can also selectively run the e2e tests for one of the scenarios:</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm-up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SCENARIO=high-touch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./hack/test-e2e-local.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gardenadm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label-filter=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;high-touch&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./test/e2e/gardenadm/...</span></span></code></pre></div><h2 id="tear-down-the-kind-cluster" tabindex="-1">Tear Down the KinD Cluster <a class="header-anchor" href="#tear-down-the-kind-cluster" aria-label="Permalink to &quot;Tear Down the KinD Cluster&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kind-down</span></span></code></pre></div>`,55)]))}const F=i(t,[["render",h]]);export{c as __pageData,F as default};
