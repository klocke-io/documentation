import{_ as a,c as i,o as e,a2 as t}from"./chunks/framework.Bfq10Vlj.js";const c=JSON.parse('{"title":"Run DISA K8s STIGs Ruleset","description":"How can I check whether my shoot cluster fulfills the DISA STIG security requirements?","frontmatter":{"aliases":["/docs/guides/security-and-compliance/partial-disa-k8s-stig-shoot/"],"description":"How can I check whether my shoot cluster fulfills the DISA STIG security requirements?","github_repo":"https://github.com/gardener/diki","github_subdir":"docs/usage","params":{"github_branch":"main"},"path_base_for_github_subdir":{"from":"content/docs/security-and-compliance/disa-k8s-stig-shoot.md","to":"disa-k8s-stig-shoot.md"},"title":"Run DISA K8s STIGs Ruleset","weight":20,"prev":false,"next":false},"headers":[],"relativePath":"docs/security-and-compliance/disa-k8s-stig-shoot/index.md","filePath":"docs/security-and-compliance/disa-k8s-stig-shoot.md","lastUpdated":null}'),n={name:"docs/security-and-compliance/disa-k8s-stig-shoot/index.md"};function o(h,s,r,l,d,p){return e(),i("div",null,s[0]||(s[0]=[t(`<h1 id="run-disa-k8s-stigs-ruleset" tabindex="-1">Run DISA K8s STIGs Ruleset <a class="header-anchor" href="#run-disa-k8s-stigs-ruleset" aria-label="Permalink to &quot;Run DISA K8s STIGs Ruleset&quot;">​</a></h1><h2 id="show-disa-k8s-stig-compliance-for-a-gardener-shoot-cluster" tabindex="-1">Show DISA K8s STIG Compliance for a Gardener Shoot Cluster <a class="header-anchor" href="#show-disa-k8s-stig-compliance-for-a-gardener-shoot-cluster" aria-label="Permalink to &quot;Show DISA K8s STIG Compliance for a Gardener Shoot Cluster&quot;">​</a></h2><h3 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h3><p>This part covers the topic of showing compliance with the DISA K8s STIG for a Gardener shoot cluster. The guide features two providers - <code>managedk8s</code> and <code>garden</code>, both of which implement rules from the DISA K8s STIG ruleset.</p><p>The <code>managedk8s</code> provider assumes that the user running the ruleset does not have access to the environment (the seed in this particular case), in which the control plane components reside.</p><p>The <code>garden</code> provider is used for accessing the<code>Garden</code> cluster, in which the <code>Shoot</code> resource can be found.</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>Since the two providers that we are going to use in this guide do not leverage access to the Shoot cluster controlplane, they only implement checks that concern configurations that cluster owners can change/modify by themselves. Compliance for configurations that cannot be influenced by cluster owners shall be ensured by the team that operates the concrete Gardener installation.</p></div><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><p>Make sure you have <a href="https://github.com/gardener/diki/blob/main/README.md#Installation" target="_blank" rel="noreferrer">diki installed</a> and have a running Gardener shoot cluster.</p><p>We will be using the sample <a href="https://github.com/gardener/diki/blob/main/example/guides/disa-k8s-stig-shoot.yaml" target="_blank" rel="noreferrer">DISA K8s STIG for Shoots configuration file</a> for this run.</p><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h3><h4 id="configure-the-managedk8s-provider" tabindex="-1">Configure the <code>managedk8s</code> provider <a class="header-anchor" href="#configure-the-managedk8s-provider" aria-label="Permalink to &quot;Configure the \`managedk8s\` provider&quot;">​</a></h4><p>Set the following arguments:</p><ul><li><code>providers[id==&quot;managedk8s&quot;].args.kubeconfigPath</code> pointing to a shoot admin kubeconfig.</li><li>(optional) <code>providers[id==&quot;managedk8s&quot;].metadata.shootName</code> should be set to the name of the shoot cluster. The <code>metadata</code> field contains custom metadata from the user that will be present in the generated report.</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">managedk8s</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Managed Kubernetes&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># custom user metadata</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # shootName: &lt;shoot-name&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # foo: bar</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    kubeconfigPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;shoot-kubeconfig-path&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # path to shoot admin kubeconfig</span></span></code></pre></div><p>In case you need instructions on how to generate such a kubeconfig, please read <a href="/docs/gardener/shoot/shoot_access/">Accessing Shoot Clusters</a>.</p><h4 id="configure-the-garden-provider" tabindex="-1">Configure the <code>garden</code> provider <a class="header-anchor" href="#configure-the-garden-provider" aria-label="Permalink to &quot;Configure the \`garden\` provider&quot;">​</a></h4><p>Set the following arguments:</p><ul><li><code>providers[id==&quot;garden&quot;].args.kubeconfigPath</code> pointing to the Garden cluster kubeconfig.</li><li><code>providers[id==&quot;garden&quot;].rulesets.args.projectNamespace</code> should be set to the namespace in which the shoot cluster is created.</li><li><code>providers[id==&quot;garden&quot;].rulesets.args.shootName</code> should be set to the name of the shoot cluster.</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">garden</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Garden&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># custom user metadata</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # foo: bar</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    kubeconfigPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;garden-kubeconfig-path&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # path to garden cluster kubeconfig</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  rulesets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">security-hardened-shoot-cluster</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Security Hardened Shoot Cluster</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">v0.2.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      projectNamespace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">garden-&lt;project-name&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # name of project namespace containing the shoot resource to be tested</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      shootName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;shoot-name&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 # name of shoot resource to be tested</span></span></code></pre></div><h4 id="additional-configurations" tabindex="-1">Additional configurations <a class="header-anchor" href="#additional-configurations" aria-label="Permalink to &quot;Additional configurations&quot;">​</a></h4><p>Additional metadata such as the shoot&#39;s name can also be included in the <code>providers[id==&quot;managedk8s|garden&quot;].metadata</code> section. The metadata section can be used to add additional context to different diki runs.</p><p>The provided configuration contain the recommended rule options for running the both providers, but you can modify rule options parameters according to requirements. All available options can be found in:</p><ul><li><a href="https://github.com/gardener/diki/blob/main/example/config/managedk8s.yaml" target="_blank" rel="noreferrer">managedk8s example configuration</a>.</li><li><a href="https://github.com/gardener/diki/blob/main/example/config/garden.yaml" target="_blank" rel="noreferrer">garden example configuration</a>.</li></ul><h3 id="running-the-disa-k8s-stigs-ruleset" tabindex="-1">Running the DISA K8s STIGs Ruleset <a class="header-anchor" href="#running-the-disa-k8s-stigs-ruleset" aria-label="Permalink to &quot;Running the DISA K8s STIGs Ruleset&quot;">​</a></h3><p>To run diki against a Gardener shoot cluster, run the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">diki</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --config=./example/guides/disa-k8s-stig-shoot.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --output=disa-k8s-stigs-report.json</span></span></code></pre></div><h3 id="generating-a-report" tabindex="-1">Generating a Report <a class="header-anchor" href="#generating-a-report" aria-label="Permalink to &quot;Generating a Report&quot;">​</a></h3><p>We can use the file generated in the previous step to create an html report by using the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">diki</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    --output=disa-k8s-stigs-report.html</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    disa-k8s-stigs-report.json</span></span></code></pre></div>`,30)]))}const g=a(n,[["render",o]]);export{c as __pageData,g as default};
