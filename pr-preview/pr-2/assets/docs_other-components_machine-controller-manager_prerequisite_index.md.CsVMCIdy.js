import{_ as e,c as i,o as a,a2 as t}from"./chunks/framework.Bfq10Vlj.js";const k=JSON.parse('{"title":"Prerequisite","description":"","frontmatter":{"github_repo":"https://github.com/gardener/machine-controller-manager","github_subdir":"docs/operations","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/docs/other-components/machine-controller-manager/prerequisite.md","to":"prerequisite.md"},"persona":"Operators","title":"Prerequisite","prev":false,"next":false},"headers":[],"relativePath":"docs/other-components/machine-controller-manager/prerequisite/index.md","filePath":"docs/other-components/machine-controller-manager/prerequisite.md","lastUpdated":null}'),n={name:"docs/other-components/machine-controller-manager/prerequisite/index.md"};function l(h,s,r,p,o,c){return a(),i("div",null,s[0]||(s[0]=[t(`<h1 id="setting-up-the-usage-environment" tabindex="-1">Setting up the usage environment <a class="header-anchor" href="#setting-up-the-usage-environment" aria-label="Permalink to &quot;Setting up the usage environment&quot;">​</a></h1><ul><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#setting-up-the-usage-environment">Setting up the usage environment</a><ul><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#important-warning">Important ⚠️</a></li><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#set-kubeconfig">Set KUBECONFIG</a></li><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#replace-provider-credentials-and-desired-vm-configurations">Replace provider credentials and desired VM configurations</a></li><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#deploy-required-crds-and-objects">Deploy required CRDs and Objects</a></li><li><a href="/docs/other-components/machine-controller-manager/prerequisite/#check-current-cluster-state">Check current cluster state</a></li></ul></li></ul><h2 id="important" tabindex="-1">Important ⚠️ <a class="header-anchor" href="#important" aria-label="Permalink to &quot;Important :warning:&quot;">​</a></h2><blockquote><p>All paths are relative to the root location of this project repository.</p></blockquote><blockquote><p>Run the Machine Controller Manager either as described in <a href="/docs/other-components/machine-controller-manager/local_setup/">Setting up a local development environment</a> or <a href="/docs/other-components/machine-controller-manager/deployment/">Deploying the Machine Controller Manager into a Kubernetes cluster</a>.</p></blockquote><blockquote><p>Make sure that the following steps are run before managing machines/ machine-sets/ machine-deploys.</p></blockquote><h2 id="set-kubeconfig" tabindex="-1">Set KUBECONFIG <a class="header-anchor" href="#set-kubeconfig" aria-label="Permalink to &quot;Set KUBECONFIG&quot;">​</a></h2><p>Using the existing <a href="https://kubernetes.io/docs/tasks/access-application-cluster/authenticate-across-clusters-kubeconfig/" target="_blank" rel="noreferrer">Kubeconfig</a>, open another Terminal panel/window with the <code>KUBECONFIG</code> environment variable pointing to this Kubeconfig file as shown below,</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> KUBECONFIG=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PATH_TO_REP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">O</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/dev/kubeconfig.yaml</span></span></code></pre></div><h2 id="replace-provider-credentials-and-desired-vm-configurations" tabindex="-1">Replace provider credentials and desired VM configurations <a class="header-anchor" href="#replace-provider-credentials-and-desired-vm-configurations" aria-label="Permalink to &quot;Replace provider credentials and desired VM configurations&quot;">​</a></h2><p>Open <code>kubernetes/machine_classes/aws-machine-class.yaml</code> and replace required values there with the desired VM configurations.</p><p>Similarily open <code>kubernetes/secrets/aws-secret.yaml</code> and replace - <em>userData, providerAccessKeyId, providerSecretAccessKey</em> with base64 encoded values of cloudconfig file, AWS access key id, and AWS secret access key respectively. Use the following command to get the base64 encoded value of your details</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;sample-cloud-config&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> base64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">base64-encoded-cloud-config</span></span></code></pre></div><p>Do the same for your access key id and secret access key.</p><h2 id="deploy-required-crds-and-objects" tabindex="-1">Deploy required CRDs and Objects <a class="header-anchor" href="#deploy-required-crds-and-objects" aria-label="Permalink to &quot;Deploy required CRDs and Objects&quot;">​</a></h2><p>Create all the required CRDs in the cluster using <code>kubernetes/crds.yaml</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/crds.yaml</span></span></code></pre></div><p>Create the class template that will be used as an machine template to create VMs using <code>kubernetes/machine_classes/aws-machine-class.yaml</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/machine_classes/aws-machine-class.yaml</span></span></code></pre></div><p>Create the secret used for the cloud credentials and cloudconfig using <code>kubernetes/secrets/aws-secret.yaml</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubernetes/secrets/aws-secret.yaml</span></span></code></pre></div><h2 id="check-current-cluster-state" tabindex="-1">Check current cluster state <a class="header-anchor" href="#check-current-cluster-state" aria-label="Permalink to &quot;Check current cluster state&quot;">​</a></h2><p>Get to know the current cluster state using the following commands,</p><ul><li>Checking aws-machine-class in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> awsmachineclass</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       MACHINE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   AMI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test-aws</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   t2.large</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       ami-123456</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   5m</span></span></code></pre></div><ul><li>Checking kubernetes secrets in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> secret</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                  TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                  DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      AGE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test-secret</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           Opaque</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         21h</span></span></code></pre></div><ul><li>Checking kubernetes nodes in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nodes</span></span></code></pre></div><p>Lists the default set of nodes attached to your cluster</p><ul><li>Checking Machine Controller Manager machines in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resources</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found.</span></span></code></pre></div><ul><li>Checking Machine Controller Manager machine-sets in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machineset</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resources</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found.</span></span></code></pre></div><ul><li>Checking Machine Controller Manager machine-deploys in the cluster</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> machinedeployment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resources</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found.</span></span></code></pre></div>`,36)]))}const g=e(n,[["render",l]]);export{k as __pageData,g as default};
