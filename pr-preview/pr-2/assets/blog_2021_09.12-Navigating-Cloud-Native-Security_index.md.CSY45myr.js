import{_ as t,c as i,o as n,a2 as r}from"./chunks/framework.Bfq10Vlj.js";const g=JSON.parse('{"title":"Navigating Cloud-Native Security - Lessons from a Recent Container Service Vulnerability","description":"","frontmatter":{"aliases":["/blog/2021/09/12/01"],"authors":[{"avatar":"https://avatars.githubusercontent.com/vlerenc","email":"vedran.lerenc@sap.com","name":"Vedran Lerenc"}],"github_repo":"https://github.com/gardener/documentation","github_subdir":"website/blog/2021","linkTitle":"Navigating Cloud-Native Security - Lessons from a Recent Container Service Vulnerability","newsSubtitle":"September 12, 2021","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/blog/2021/09.12-Navigating-Cloud-Native-Security.md","to":"09.12-Navigating-Cloud-Native-Security.md"},"publishdate":"2021-09-12","title":"Navigating Cloud-Native Security - Lessons from a Recent Container Service Vulnerability"},"headers":[],"relativePath":"blog/2021/09.12-Navigating-Cloud-Native-Security/index.md","filePath":"blog/2021/09.12-Navigating-Cloud-Native-Security.md","lastUpdated":null}'),a={name:"blog/2021/09.12-Navigating-Cloud-Native-Security/index.md"};function o(s,e,l,c,d,u){return n(),i("div",null,e[0]||(e[0]=[r('<h1 id="navigating-cloud-native-security-lessons-from-a-recent-container-service-vulnerability" tabindex="-1">Navigating Cloud-Native Security - Lessons from a Recent Container Service Vulnerability <a class="header-anchor" href="#navigating-cloud-native-security-lessons-from-a-recent-container-service-vulnerability" aria-label="Permalink to &quot;Navigating Cloud-Native Security - Lessons from a Recent Container Service Vulnerability&quot;">​</a></h1><p>The cloud-native landscape is constantly evolving, bringing immense benefits in agility and scale. However, with this evolution comes a complex and ever-changing threat landscape. Recently, a <a href="https://unit42.paloaltonetworks.com/azure-container-instances" target="_blank" rel="noreferrer">significant vulnerability was reported by Unit 42 concerning Azure Container Instances (ACI)</a>, a service designed to run containers in a multi-tenant environment. This incident offers valuable lessons for the entire community, and we at Gardener believe in sharing insights that can help strengthen collective security.</p><p>This particular vulnerability underscores the critical importance of vigilance, timely patching, and defense-in-depth, principles we have long championed within the Gardener project.</p><h3 id="understanding-the-aci-vulnerability" tabindex="-1">Understanding the ACI Vulnerability <a class="header-anchor" href="#understanding-the-aci-vulnerability" aria-label="Permalink to &quot;Understanding the ACI Vulnerability&quot;">​</a></h3><p>As detailed in the Unit 42 report, the attack vector on ACI involved several stages, leveraging a combination of outdated software and architectural choices:</p><ol><li><strong>Outdated <code>runc</code>:</strong> The initial entry point exploited a version of <code>runc</code> from October 2016. This version was susceptible to <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-5736" target="_blank" rel="noreferrer">CVE-2019-5736</a>, a critical vulnerability allowing host takeover. This vulnerability was widely publicized in early 2019.</li><li><strong>Lateral Movement via Kubelet Impersonation:</strong> After gaining node access, the next step involved attempting to impersonate the Kubelet to interact with the Kubernetes API server. The ACI clusters were reportedly running Kubernetes versions (v1.8.x - v1.10.x) from 2017/2018, which were, in principle, vulnerable to such an attack.</li><li><strong>Exploiting a Custom Bridge Component:</strong> While the direct Kubelet impersonation didn&#39;t work as initially expected, investigators found that a custom bridge component, designed to abstract the underlying Kubernetes, became the next target. This proprietary component inadvertently held a service account token with <code>cluster-admin</code> privileges. By capturing this token, attackers could gain full control over the Kubernetes cluster.</li><li><strong>Control Plane Access:</strong> The report also noted that the API server appeared to be self-hosted, potentially allowing easier movement from the data plane to the control plane environment once cluster-admin privileges were obtained.</li><li><strong>Alternative Attack Vector:</strong> A second distinct attack vector, also leveraging the custom bridge component, was identified, pointing to another area where security hardening could have prevented compromise.</li></ol><h3 id="gardener-s-proactive-security-posture" tabindex="-1">Gardener’s Proactive Security Posture <a class="header-anchor" href="#gardener-s-proactive-security-posture" aria-label="Permalink to &quot;Gardener’s Proactive Security Posture&quot;">​</a></h3><p>The ACI incident highlights several threat vectors that the Gardener team has actively worked to mitigate over the years, often well in advance of them becoming widely exploited.</p><ul><li><strong>Timely Patching of Critical Vulnerabilities (e.g., <code>runc</code> CVE-2019-5736):</strong> When CVE-2019-5736 was pre-disclosed, the Gardener team treated it with utmost seriousness. We had announcements and patches prepared, rolling them out on the day of public disclosure. This rapid response is crucial for minimizing exposure to known high-severity vulnerabilities.</li><li><strong>Hardening Against Exploits:</strong> The Kubelet impersonation vector mentioned in the ACI report is particularly relevant to Gardener. The underlying Kubernetes vulnerability (CVE-2020-8558, tracked as Kubernetes issue <a href="https://github.com/kubernetes/kubernetes/issues/85867" target="_blank" rel="noreferrer">#85867</a>) that could allow a compromised node/Kubelet to redirect API server traffic (like <code>kubectl exec</code>) was discovered and reported by Alban Crequy from Kinvolk. This discovery was made during a penetration test commissioned by the Gardener project, specifically asking to find loopholes in our seed clusters. We were able to implement mitigations in Gardener even before the upstream Kubernetes fix was available, further securing our seed cluster architecture. The second distinct attack vector was also discovered during such a penetration test and Gardener further hardened its network policies.</li><li><strong>Principle of Least Privilege and Secure Component Design:</strong> The ACI bridge component&#39;s <code>cluster-admin</code> token is a stark reminder of the dangers of overly privileged components, especially those interacting with user workloads. Within Gardener, we&#39;ve invested heavily in mechanisms like the Gardener Seed Authorizer (as discussed in Gardener issue <a href="https://github.com/gardener/gardener/issues/1723" target="_blank" rel="noreferrer">#1723</a>). It goes beyond standard RBAC to strictly limit the capabilities of components and prevent lateral movement, ensuring that even if one part is compromised, the blast radius is contained. We also meticulously review and restrict permissions for all components.</li><li><strong>Strict Separation of Concerns:</strong> A core architectural principle in Gardener is the strict separation between the control plane and the data plane - at all levels. Being an administrator in a shoot cluster does not grant any access to the underlying seed cluster&#39;s control plane execution environment or the upper hierarchy of runtime and garden cluster, a critical defense against escalation.</li></ul><h3 id="learning-and-moving-forward" tabindex="-1">Learning and Moving Forward <a class="header-anchor" href="#learning-and-moving-forward" aria-label="Permalink to &quot;Learning and Moving Forward&quot;">​</a></h3><p>The ACI vulnerability is a powerful reminder that security is not a one-time task but a continuous process of vigilance, proactive hardening, and learning from every incident, whether our own or others&#39;. No system is impenetrable, and the assumption that any single entity, regardless of size, has perfected security can lead to complacency.</p><p>At Gardener, we remain committed to:</p><ul><li><strong>Staying current:</strong> Diligently updating dependencies and core components.</li><li><strong>Defense-in-depth:</strong> Implementing multiple layers of security controls.</li><li><strong>Proactive discovery:</strong> Continuously testing and seeking out potential weaknesses.</li><li><strong>Community collaboration:</strong> Sharing knowledge and contributing to upstream security efforts.</li></ul><p>We believe that by fostering a culture of security awareness and investing in robust, layered defenses, we can build more resilient cloud-native systems for everyone. This recent industry event, while unfortunate for those affected, provides crucial learning points that reinforce our commitment to the security principles embedded in Gardener. We will continue to evolve Gardener&#39;s security posture, always striving to stay ahead of emerging threats.</p>',14)]))}const p=t(a,[["render",o]]);export{g as __pageData,p as default};
