import{_ as t,c as r,o,a2 as n}from"./chunks/framework.Bfq10Vlj.js";const h=JSON.parse('{"title":"Add New Etcd Cluster Component","description":"","frontmatter":{"github_repo":"https://github.com/gardener/etcd-druid","github_subdir":"docs/development","params":{"github_branch":"master"},"path_base_for_github_subdir":{"from":"content/docs/other-components/etcd-druid/add-new-etcd-cluster-component.md","to":"add-new-etcd-cluster-component.md"},"persona":"Developers","title":"Add New Etcd Cluster Component","prev":false,"next":false},"headers":[],"relativePath":"docs/other-components/etcd-druid/add-new-etcd-cluster-component/index.md","filePath":"docs/other-components/etcd-druid/add-new-etcd-cluster-component.md","lastUpdated":null}'),a={name:"docs/other-components/etcd-druid/add-new-etcd-cluster-component/index.md"};function c(d,e,l,s,i,p){return o(),r("div",null,e[0]||(e[0]=[n('<h1 id="add-a-new-etcd-cluster-component" tabindex="-1">Add A New Etcd Cluster Component <a class="header-anchor" href="#add-a-new-etcd-cluster-component" aria-label="Permalink to &quot;Add A New Etcd Cluster Component&quot;">â€‹</a></h1><p><code>etcd-druid</code> defines an <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/component/types.go#L42" target="_blank" rel="noreferrer">Operator</a> which is responsible for creation, deletion and update of a resource that is created for an <code>Etcd</code> cluster. If you want to introduce a new resource for an <code>Etcd</code> cluster then you must do the following:</p><ul><li><p>Add a dedicated <code>package</code> for the resource under <a href="https://github.com/gardener/etcd-druid/tree/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/component" target="_blank" rel="noreferrer">component</a>.</p></li><li><p>Implement <code>Operator</code> interface.</p></li><li><p>Define a new <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/component/registry.go#L19" target="_blank" rel="noreferrer">Kind</a> for this resource in the operator <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/component/registry.go#L8" target="_blank" rel="noreferrer">Registry</a>.</p></li><li><p>Every resource a.k.a <code>Component</code> needs to have the following set of default labels:</p><ul><li><code>app.kubernetes.io/name</code> - value of this label is the name of this component. Helper functions are defined <a href="https://github.com/gardener/etcd-druid/blob/master/api/core/v1alpha1/helper.go" target="_blank" rel="noreferrer">here</a> to create the name of each component using the parent <code>Etcd</code> resource. Please define a new helper function to generate the name of your resource using the parent <code>Etcd</code> resource.</li><li><code>app.kubernetes.io/component</code> - value of this label is the type of the component. All component type label values are defined <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/common/constants.go" target="_blank" rel="noreferrer">here</a> where you can add an entry for your component.</li><li>In addition to the above component specific labels, each resource/component should have default labels defined on the <code>Etcd</code> resource. You can use <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/api/v1alpha1/helper.go#L124" target="_blank" rel="noreferrer">GetDefaultLabels</a> function.</li></ul><blockquote><p>These labels are also part of <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/" target="_blank" rel="noreferrer">recommended labels</a> by kubernetes. NOTE: Constants for the label keys are already defined <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/api/v1alpha1/constants.go" target="_blank" rel="noreferrer">here</a>.</p></blockquote></li><li><p>Ensure that there is no <code>wait</code> introduced in any <code>Operator</code> method implementation in your component. In case there are multiple steps to be executed in a sequence then re-queue the event with a special <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/errors/errors.go#L19" target="_blank" rel="noreferrer">error code</a> in case there is an error or if the pre-conditions check to execute the next step are not yet satisfied.</p></li><li><p>All errors should be wrapped with a custom <a href="https://github.com/gardener/etcd-druid/blob/3383e0219a6c21c6ef1d5610db964cc3524807c8/internal/errors/errors.go#L24" target="_blank" rel="noreferrer">DruidError</a>.</p></li></ul>',3)]))}const b=t(a,[["render",c]]);export{h as __pageData,b as default};
